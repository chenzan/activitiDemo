<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>index</title>
</head>
<body>
<div>
    ====================================================================================================
    <div>
        <form th:action="@{/leave/apply}">
            <input hidden name="userId" th:value="${session.current_user.id}"/>
            请假人<input readonly name="username" th:value="${session.current_user.username}"/><br/>
            天数<input type="number" name="day"/><br/>
            备注<input name="remark"/><br/>
            <input type="submit" th:value="申请">
        </form>
    </div>
    ====================================================================================================
    <table border="1">
        <caption>个人任务</caption>
        <tr>
            <th>任务id</th>
            <th>任务名称</th>
            <th>办理人</th>
            <th>创建时间</th>
            <th>操作</th>
        </tr>
        <tr th:each="task,tStat : ${tasks}">
            <td th:text="${task.id}"></td>
            <td th:text="${task.name}"></td>
            <td th:text="${task.assignee}"></td>
            <td th:text="${#dates.format(task.createTime,'yyyy-MM-dd HH:mm:ss')}"></td>
            <td>
                <a target="_blank" th:href="@{/leave/handlerLeave(taskId=${task.id})}">办理任务</a>
                <a target="_blank" th:href="@{/workflow/curProcessImg(taskId=${task.id})}">查看当前流程</a>
            </td>
        </tr>
    </table>
    ====================================================================================================
    <table border="1">
        <caption>请假记录</caption>
        <tr>
            <th>id</th>
            <th>请假原因</th>
            <th>天数</th>
            <th>操作</th>
        </tr>
        <tr th:each="leave,lStat : ${leaves}">
            <td th:text="${leave.id}"></td>
            <td th:text="${leave.leaveReason}"></td>
            <td th:text="${leave.leaveDay}"></td>
            <td>
                <a target="_blank" th:href="@{/leave/leaveLog(leaveId=${leave.id})}">查看</a>
            </td>
        </tr>
    </table>
    ====================================================================================================
    <table border="1">
        <caption>部署信息</caption>
        <tr>
            <th>部署id</th>
            <th>部署名称</th>
            <th>部署时间</th>
            <th>操作</th>
        </tr>
        <tr th:each="deployment,userStat : ${deployments}">
            <td th:text="${deployment.id}"></td>
            <td th:text="${deployment.name}"></td>
            <td th:text="${#dates.format(deployment.deploymentTime,'yyyy-MM-dd HH:mm:ss')}"></td>
            <td>
                <a th:href="@{/workflow/deploymentDel(deploymentId=${deployment.id})}">删除</a>
            </td>
        </tr>
    </table>
    <br/>
    <table border="1">
        <caption>流程定义信息</caption>
        <tr>
            <th>id</th>
            <th>名称</th>
            <th>流程定义key</th>
            <th>版本</th>
            <th>流程定义规则文件名称</th>
            <th>流程定义规则图片名称</th>
            <th>部署id</th>
            <th>操作</th>
        </tr>
        <tr th:each="definitionP,defStat : ${definitionProcess}">
            <td th:text="${definitionP.id}"></td>
            <td th:text="${definitionP.name}"></td>
            <td th:text="${definitionP.key}"></td>
            <td th:text="${definitionP.version}"></td>
            <td th:text="${#strings.substringAfter(definitionP.getResourceName(),'leave\')}"></td>
            <td th:text="${#strings.substringAfter(definitionP.getDiagramResourceName(),'leave\')}"></td>
            <td th:text="${definitionP.deploymentId}"></td>
            <td>
                <a href="index.html" target="_blank"
                   th:href="@{/workflow/processImg(deploymentId=${definitionP.deploymentId},resourceName= ${definitionP.getDiagramResourceName()})}">查看流程图</a>
            </td>
        </tr>
    </table>
</div>
</body>
</html>